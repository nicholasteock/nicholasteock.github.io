{"version":3,"sources":["app/application.js","app/initialize.js","app/preload.js","app/preloader.js","app/shaker.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA/LA;AAAA;ACAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAlDA;AAAA;ACAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAzBA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AArDA;AAAA;ACAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AArHA;AAAA","file":"public/js/app.js","sourcesContent":["// Hosted on: http://bitly.com/1z99Dhc\nvar ingredientCount \t\t= 4;\nvar currentIngredientIdx \t= 0;\nvar currentStageIdx \t\t= 0;\nvar tossIdx \t\t\t\t= 0;\nvar maxTosses \t\t\t\t= 3;\nvar stageNames \t\t\t\t= ['main', 'ingredients', 'toss', 'share'];\nvar url \t\t\t\t\t= encodeURIComponent('http://bitly.com/1z99Dhc');\nvar shareMessage \t\t\t= \"Hi there! Let's Lou Hei together at: \" + url;\n\nvar initialize = function() {\n\t$('.stage').addClass('hide');\n\t$('.plate').addClass('hide');\n\t$('.share-container').removeClass('in');\n\t$('.credits').removeClass('in');\n\t$('.ingredient-banner').addClass('hide');\n\t$('.desc-banner').addClass('hide');\n\t$('.main-plate').addClass('hide');\n\t$('.mini-plate').addClass('hide');\n\t$('.chunk-plate').removeClass('hide');\n\t$('.bounce').removeClass('bounce');\n\n\t$('.main-stage').removeClass('hide');\n\t// $('.toss-stage').removeClass('hide');\n\t$('.js-plate-0').removeClass('hide');\n\t$('.js-main-0').removeClass('hide');\n\n\tcurrentIngredientIdx \t= 0;\n\tcurrentStageIdx \t\t= 0;\n\ttossIdx \t\t\t\t= 0;\n\n\t$(document).trigger('disable_shaker');\n};\n\nvar plateClickHandler = function() {\n\tvar i = 0;\n\tvar lastIngredient = 6;\n\n\tvar showIngredients = function () {\n\t\tvar lastIngredient = 6;\n\n\t\t// Transit to next stage (adding ingredients)\n\t\tif (i >= lastIngredient) {\n\t\t\tsetTimeout( function() {\n\t\t\t\tnextStage();\n\t\t\t\tshowIngredient();\n\t\t\t}, 1400);\n\t\t\treturn;\n\t\t}\n\n\t\tsetTimeout(function () {\n\t\t\t$('.js-plate-'+i).addClass('hide');\n\t\t\ti++;\n\t\t\t$('.js-plate-'+i).removeClass('hide');\n\t\t\tshowIngredients();\n\t\t}, 400);\n\t};\n\n\tshowIngredients();\n};\n\nvar showIngredient = function() {\n\t$('.ingredient-banner').addClass('hide');\n\t$('.js-ingredient-'+currentIngredientIdx).removeClass('hide');\n\t\n\t$('.desc-banner').removeClass('bounce').addClass('hide');\n\t$('.js-desc-'+currentIngredientIdx).addClass('bounce').removeClass('hide');\n\t\n\t$('.mini-plate').addClass('hide');\n\t$('.js-mini-'+currentIngredientIdx).removeClass('hide');\n\n\t$('.ingredient-name-container').addClass('in');\n\t$('.ingredient-desc-container').addClass('hide');\n\t$('.mini-plate-container').addClass('in');\n};\n\nvar showIngredientDesc = function() {\n\t$('.ingredient-name-container').removeClass('in');\n\t$('.ingredient-desc-container').removeClass('hide');\n\t$('.main-plate').addClass('hide');\n\t$('.js-main-'+(currentIngredientIdx+1)).removeClass('hide');\n\t$('.mini-plate-container').removeClass('in');\n\n\tcurrentIngredientIdx++;\n\tsetTimeout(function() {\n\t\tisLastIngredient() ? nextStage() : showIngredient();\n\t}, 2400);\n};\n\nvar showShareButtons = function() {\n\tvar $plate = $(\".chunk-plate-container\");\n\n\tvar hideChunks = function (chunkIdx, totalChunks) {\n\t\tsetTimeout(function () {\n\t\t\tif (chunkIdx === totalChunks) {\n\t\t\t\t$('.js-message-0').addClass('hide');\n\t\t\t\t$('.js-message-1').removeClass('hide').addClass('bounce');\n\t\t\t\t$('.share-container').addClass('in');\n\t\t\t\t$('.credits').addClass('in');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t$plate.find('.js-chunk-'+chunkIdx).addClass('hide');\n\t\t\thideChunks(chunkIdx+1, totalChunks);\n\t\t}, 222);\n\t};\n\thideChunks(1,5); // Start from 1, total 5 chunks\n};\n\nvar doToss = function() {\n\tvar $plate = $(\".toss-plate-container\");\n\n\tvar toss = function(frameIdx, totalFrames) {\n\t\tsetTimeout(function() {\n\t\t\tif(frameIdx === (totalFrames-1)) {\n\t\t\t\t$plate.find('.js-toss-'+(totalFrames-1)).addClass('hide');\n\t\t\t\t$plate.find('.js-toss-0').removeClass('hide');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t$plate.find('.js-toss-'+frameIdx).addClass('hide');\n            $plate.find('.js-toss-'+(frameIdx+1)).removeClass('hide');\n\t\t\ttoss(frameIdx+1, totalFrames);\n\t\t}, 246);\n\t};\n\n\ttoss(0,4); // Start from frame 0 with total 4 frames.\n};\n\nvar isLastIngredient = function() {\n\treturn currentIngredientIdx === ingredientCount;\n};\n\nvar nextStage = function() {\n\t$('.' + stageNames[currentStageIdx] + '-stage').addClass('hide');\n\tcurrentStageIdx++;\n\t$('.' + stageNames[currentStageIdx] + '-stage').removeClass('hide');\n\n\tif(stageNames[currentStageIdx] === 'toss') {\n\t\t$(document).trigger('enable_shaker');\n\t}\n\treturn;\n};\n\nvar shareLink = function(type) {\n\t// Prefix message with url scheme.\n\tswitch (type) {\n\t\tcase 'whatsapp':\n\t\t\turl = \"whatsapp://send?text=\" + shareMessage;\n\t\t\tbreak;\n\t\tcase 'sms':\n\t\t\tif (/iPhone|iPad|iPod/i.test(navigator.userAgent)) {\n\t\t\t\turl = \"sms:;body=\" + shareMessage;\n\t\t\t}\n\t\t\telse if (/Android/i.test(navigator.userAgent)) {\n\t\t\t\turl = \"sms:?body=\" + shareMessage;\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t};\n\tlocation.href = url;\n};\n\nvar toss = function() {\n\tconsole.log('Play animation.');\n\tdoToss();\n\ttossIdx += 1;\n\t$(\"#tossStatus\").html(tossIdx+'/'+maxTosses);\n\n\tif(tossIdx > maxTosses) {\n\t\t$(\"#tossStatus\").html('Going to next stage...');\n\t\t$(document).trigger('disable_shaker');\n\t\tnextStage();\n\t}\n\telse {\n\t\tsetTimeout( function() {\n\t\t\t$(document).trigger('enable_shaker');\n\t\t}, 1000);\n\t}\n};\n\nmodule.exports = {\n\tinitialize \t\t\t: initialize,\n\tplateClickHandler \t: plateClickHandler,\n\tshowIngredient \t\t: showIngredient,\n\tshowIngredientDesc \t: showIngredientDesc,\n\tisLastIngredient \t: isLastIngredient,\n\tnextStage \t\t\t: nextStage,\n\ttoss \t\t\t\t: toss,\n\tshowShareButtons \t: showShareButtons,\n\tshareLink\t\t\t: shareLink\n};\n","var shaker \t\t\t= require('shaker');\nvar application \t= require('application');\n\n$(function() {\n\t$('.loading-overlay').addClass('hide');\n\t\n\tapplication.initialize();\n\n\t$('.main-stage .js-plate-0').click(function() {\n\t\tapplication.plateClickHandler();\n\t});\n\n\t$('.ingredients-stage .mini-plate-container').click(function() {\n\t\tapplication.showIngredientDesc();\n\t});\n\n\t$('.share-stage .chunk-plate-container').click(function() {\n\t\tapplication.showShareButtons();\n\t});\n\n\t$('.js-share-whatsapp').click(function() {\n\t\tsetTimeout( function() {\n\t\t\tapplication.shareLink('whatsapp');\n\t\t}, 100);\n\t});\n\n\t$('.js-share-sms').click(function(el) {\n\t\tsetTimeout( function() {\n\t\t\tapplication.shareLink('sms');\n\t\t}, 100);\n\t});\n\n\t$(document).on('enable_shaker', function() {\n\t\tshaker.enable();\n\t});\n\n\t$(document).on('disable_shaker', function() {\n\t\tshaker.disable();\n\t});\n\n\t$(document).on('protoss', function() {\n\t\tapplication.toss();\n\t});\n\n\t// Temp event to test transitions (gray box)\n\t// $('.nextStage').click(function() {\n\t// \t$('.toss-stage').addClass('hide');\n\t// \t$('.share-stage').removeClass('hide');\n\t// });\n});\n","module.exports = function(imageArr, callback){\n\tvar $progress = $('#progress').text('0%'),\n\t\tloader = new PxLoader();\n\n\t// loader.addProgressListener(function(e) { \n // \t\tconsole.log(e.completedCount + ' / ' + e.totalCount);\n\t//     // the event provides stats on the number of completed items \n\t//     $progress.innerHt(e.completedCount + ' / ' + e.totalCount); \n\t// });\n\n\tloader.addCompletionListener(callback);\n\n\tfor(var i= 0; i < imageArr.length; i++){\n\t\tvar pxImage = new PxLoaderImage(imageArr[i]); \n\t\tloader.addImage(pxImage);\n\t}\n\n\tthis.start = function() {\n\t\tloader.start();\n\t};\n\n\treturn this;\n}\n\n\n// PRELOADER PRELOADER PRELOADER PRELOADER PRELOADER","module.exports = function(callback) {\n\n\tvar Preload = require('preload');\n\n\tvar preload = new Preload(\n\t\t[\n\t\t\t'images/rotate_device.png',\n\t\t\t'images/bg_text_00.png',\n\t\t\t'images/loadingplates_01.png',\n\t\t\t'images/loadingplates_02.png',\n\t\t\t'images/loadingplates_03.png',\n\t\t\t'images/loadingplates_04.png',\n\t\t\t'images/loadingplates_05.png',\n\t\t\t'images/loadingplates_06.png',\n\t\t\t'images/loadingplates_07.png',\n\t\t\t'images/bg_text_short_01.png',\n\t\t\t'images/bg_text_short_02.png',\n\t\t\t'images/bg_text_short_03.png',\n\t\t\t'images/bg_text_short_04.png',\n\t\t\t'images/bg_text_short.png',\n\t\t\t'images/mainplate_ingredients_00.png',\n\t\t\t'images/mainplate_ingredients_01.png',\n\t\t\t'images/mainplate_ingredients_02.png',\n\t\t\t'images/mainplate_ingredients_03.png',\n\t\t\t'images/mainplate_ingredients_04.png',\n\t\t\t'images/fish_text.png',\n\t\t\t'images/pepper_text.png',\n\t\t\t'images/sauce_text.png',\n\t\t\t'images/crackers_text.png',\n\t\t\t'images/miniplate_0.png',\n\t\t\t'images/miniplate_1.png',\n\t\t\t'images/miniplate_2.png',\n\t\t\t'images/miniplate_3.png',\n\t\t\t'images/tossing/tossing_01.png',\n\t\t\t'images/tossing/tossing_02.png',\n\t\t\t'images/tossing/tossing_03.png',\n\t\t\t'images/tossing/tossing_04.png',\n\t\t\t'images/bg_text_short_07.png',\n\t\t\t'images/bg_text_short_08.png',\n\t\t\t'images/mainplate_eaten_last.png',\n\t\t\t'images/mainplate_eatenpiece_01.png',\n\t\t\t'images/mainplate_eatenpiece_02.png',\n\t\t\t'images/mainplate_eatenpiece_03.png',\n\t\t\t'images/mainplate_eatenpiece_04.png',\n\t\t\t'images/mainplate_eatenpiece_05.png',\n\t\t\t'images/icon_wa.png',\n\t\t\t'images/icon_sms.png',\n\t\t\t'images/2359logo.png'\n\t\t],\n\t\tcallback\n\t);\n\n\tpreload.start();\n};","/******************************************************************************\n\tshaker.js\n\t\n\t- Handles device orientation.\n\n\t- When device orientation changes, we monitor the change and sense the\n\t  orientation.\n\n\t- Depending on orientation ( forwards / backwards ) we can then make the \n\t  required trigger which is handled in index.js\n\n******************************************************************************/\n\nvar deviceType,\n\tANDROID = 0,\n\tIOS = 1,\n\tWINDOWS = 2,\n\tUNKNOWN = -1;\n\nif (/Android/i.test(navigator.userAgent)) {\n\tdeviceType = ANDROID;\n} else if (/iPhone|iPad|iPod/i.test(navigator.userAgent)) {\n\tdeviceType = IOS;\n}else if (/Windows/i.test(navigator.userAgent)) {\n\tdeviceType = WINDOWS;\n} else {\n\tdeviceType = UNKNOWN;\n}\n\nvar enabled \t\t\t= false;\nvar highpointReached \t= false;\nvar preventToss \t\t= false;\n\nvar enable = function() {\n\tenabled = true;\n\tif (window.DeviceMotionEvent) {\n\t  // Listen for the event and handle DeviceOrientationEvent object\n\t  // window.addEventListener( 'deviceorientation', tiltHandler );\n\t  window.addEventListener( 'devicemotion', tiltHandler );\n\t}\n\telse {\n\t\tconsole.error('DeviceMotionEvent undefined');\n\t}\n\treturn;\n};\n\nvar disable = function() {\n\tenabled = false;\n\tif (window.DeviceMotionEvent) {\n\t  // Listen for the event and handle DeviceOrientationEvent object\n\t  // window.addEventListener( 'deviceorientation', tiltHandler );\n\t  window.removeEventListener( 'devicemotion', tiltHandler );\n\t}\n\telse {\n\t\tconsole.error('DeviceMotionEvent undefined');\n\t}\n\treturn;\n};\n\nvar androidTiltHandler = function(evt) {\n\tvar zAcceleration = Math.round(evt.accelerationIncludingGravity.z);\n\n\t// $(\"#debug2\").html(\"<h3>Android Acceleration</h3><ul><li>X: \"+Math.round(evt.accelerationIncludingGravity.x)+\"</li><li>Y: \"+Math.round(evt.accelerationIncludingGravity.y)+\"</li><li>Z: \"+Math.round(evt.accelerationIncludingGravity.z)+\"</li></ul>\");\n\t// $(\"#debug3\").html(\"<h3>Rotation</h3><ul><li>X: \"+Math.round(evt.rotationRate.alpha)+\"</li><li>Y: \"+Math.round(evt.rotationRate.beta)+\"</li><li>Z: \"+Math.round(evt.rotationRate.gamma)+\"</li></ul>\");\n\t// $(\"#debug4\").html(\"<h3>Prevent Toss</h3><ul><li>\"+preventToss+\"</li></ul>\");\n\n\tif(zAcceleration > -10) {\n\t\tif(!highpointReached) {\n\t\t\thighpointReached = true;\n\t\t}\n\t\treturn;\n\t}\n\tif(zAcceleration < 16 && highpointReached) {\n\t\thighpointReached = false;\n\t\tdisable(); // Disable further tosses while showing toss.\n\t\t$(document).trigger('protoss'); // Trigger tossing\n\t}\n}\n\nvar iosTiltHandler = function(evt) {\n\tvar zAcceleration = Math.round(evt.accelerationIncludingGravity.z);\n\n\t// $(\"#debug2\").html(\"<h3>IOS Acceleration</h3><ul><li>X: \"+Math.round(evt.accelerationIncludingGravity.x)+\"</li><li>Y: \"+Math.round(evt.accelerationIncludingGravity.y)+\"</li><li>Z: \"+Math.round(evt.accelerationIncludingGravity.z)+\"</li></ul>\");\n\t// $(\"#debug3\").html(\"<h3>Rotation</h3><ul><li>X: \"+Math.round(evt.rotationRate.alpha)+\"</li><li>Y: \"+Math.round(evt.rotationRate.beta)+\"</li><li>Z: \"+Math.round(evt.rotationRate.gamma)+\"</li></ul>\");\n\t// $(\"#debug4\").html(\"<h3>Prevent Toss</h3><ul><li>\"+preventToss+\"</li></ul>\");\n\n\tif(zAcceleration >= 5) {\n\t\tif(!highpointReached) {\n\t\t\thighpointReached = true;\n\t\t}\n\t\treturn;\n\t}\n\tif(zAcceleration <= -15 && highpointReached) {\n\t\thighpointReached = false;\n\t\tdisable(); // Disable further tosses while showing toss.\n\t\t$(document).trigger('protoss'); // Trigger tossing\n\t}\n};\n\nfunction tiltHandler( evt ) {\n\tif(!enabled) return;\n\n\tif (deviceType === ANDROID) {\n\t\tandroidTiltHandler(evt);\n\t} else if (deviceType === IOS || deviceType === WINDOWS) {\n\t\tiosTiltHandler(evt);\n\t}\n};\n\nvar supportsTilt = function() {\n\treturn (window.DeviceOrientationEvent && typeof window.orientation !== \"undefined\");\n};\n\nmodule.exports = {\n\tsupportsTilt: supportsTilt,\n\tenable \t\t: enable,\n\tdisable \t: disable\n};"]}